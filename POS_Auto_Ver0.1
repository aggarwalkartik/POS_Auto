'***********Following code is to mine sales data on Genisys and email it in a text file******************

dim WshShell, file
Set WshShell = WScript.CreateObject("WScript.Shell")			        'Create a shell object
file =  "C:\Users\Administrator\Desktop\Sales_cube.dis"			        'Path to the cube			
Cube = WshShell.Run(file)						        'Run the cube				
WshShell.SendKeys "misretail"				                      	'Enter Client ID on Genisys
WshShell.SendKeys "{TAB}"					                'Move to password field		
WshShell.SendKeys "gmpl"					                'Enter Password
WshShell.SendKeys "{TAB}"				
WshShell.SendKeys "{TAB}"				
WshShell.SendKeys "{ENTER}"				                        'Connect to Database
WshShell.SendKeys "{ENTER}"					                'Confirm the cube
WshShell.SendKeys "1-Sep-17"				                      	'Enter start date for data
WshShell.SendKeys "{TAB}"						        'Move to end date field
WshShell.SendKeys "1-Sep-17"			                      		'Enter end date for data
WshShell.SendKeys "{TAB}"					                'Move to confirm button	
WshShell.SendKeys "{ENTER}"					                'Confirm dates
WScript.Sleep 15*1000						                'Sleep for 15 seconds to determine query time
WshShell.SendKeys "{ENTER}"			                        	'Run Query	
WScript.Sleep 20*60*1000				                        'Sleep for 20 minutes to execute query
WshShell.SendKeys "%E"				                          	'Open Edit tab
WScript.Sleep 1000						                'Sleep for 1 second
WshShell.SendKeys "^"					                        'Select all
WScript.Sleep 1000
WshShell.SendKeys "A"
WScript.Sleep 1000
WshShell.SendKeys "%E"					                        'Copy data
WScript.Sleep 1000
WshShell.SendKeys "{DOWN}"
WScript.Sleep 1000
WshShell.SendKeys "{DOWN}"
WScript.Sleep 1000
WshShell.SendKeys "{DOWN}"
WScript.Sleep 1000
WshShell.SendKeys "{ENTER}"
WScript.Sleep 20*1000						                'Sleep for 20 seconds to copy data
Set WshShell = Nothing

'*************Script to copy data to notepad starts here*************************************************

dim S, X
Set S = CreateObject("WScript.Shell")
Set X = S.Exec("Notepad.exe")					                'Open Notepad
WScript.sleep 1000
S.SendKeys "^V"						                        'Paste data
wscript.sleep 1000
S.SendKeys "%"
wscript.sleep 1000
S.SendKeys "F"
wscript.sleep 1000
S.SendKeys "^"
wscript.sleep 1000
S.SendKeys "S"							                'Save text file
wscript.sleep 1000
S.SendKeys "Sales_Data"					                        'Enter file name
wscript.sleep 1000
S.SendKeys "~" 							                'Confirm file name
X.Terminate() 							                'Close notepad
Set X = Nothing
Set S = Nothing
WScript.Sleep 10*1000

'************Script to send data in email starts here******************************************************

EmailSubject = "Data from Genisys"					        'Enter Mail subject
EmailBody = "This is an autogenerated e-mail with attached data from genisys sent via" & vbCRLF & _
        "a CDO.Message object using SMTP authentication, with port 465."

Const EmailFrom = "abc@gmail.com"				                   	'Sender's Email
Const EmailFromName = "XYXYXYXYX"					                  'Sender's name
Const EmailTo = "xxxxxxx@gmail.com"				                 	'Reciever's Email
Const SMTPServer = "smtp.gmail.com"					                'SMTP server for gmail
Const SMTPLogon = "abc@gmail.com"				                  	'Gmail ID
Const SMTPPassword = "xxxxxxx"					                    'Password
Const SMTPSSL = True
Const SMTPPort = 465

Const cdoSendUsingPickup = 1                                'Send message using local SMTP service pickup directory.
Const cdoSendUsingPort = 2                                  'Send the message using SMTP over TCP/IP networking.

Const cdoAnonymous = 0                                      'No authentication
Const cdoBasic = 1                                          'BASIC clear text authentication
Const cdoNTLM = 2                                           'NTLM, Microsoft proprietary authentication

'*************Create the message***********************************************************************

Set objMessage = CreateObject("CDO.Message")
objMessage.Subject = EmailSubject
objMessage.From = """" & EmailFromName & """ <" & EmailFrom & ">"
objMessage.To = EmailTo
objMessage.TextBody = EmailBody
objMessage.AddAttachment "C:\Users\Administrator\Desktop\Test\Sales_Data.txt"

'*************Configure the server***********************************************************************

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/smtpserver") = SMTPServer

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/smtpauthenticate") = cdoBasic

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/sendusername") = SMTPLogon

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/sendpassword") = SMTPPassword

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = SMTPPort

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/smtpusessl") = SMTPSSL

objMessage.Configuration.Fields.Item _
("http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout") = 60

objMessage.Configuration.Fields.Update
'Now send the message!
On Error Resume Next
objMessage.Send

If Err.Number <> 0 Then
    MsgBox Err.Description,16,"Error Sending Mail"
Else 
    MsgBox "Mail was successfully sent!",64,"Information"
End If
